{# This template is for a daily overview. #}

{% extends "base.html" %}
{% block title %}Weather for {{ data.this_month }}{% endblock %}
{% block head %}{% endblock %}
{% block content %}

        <header>
            <div class="row">
                <div class="span6">
                    <h1>Weather for {{ data.this_month }} {{ data.year_stamp }}</h1>
                </div>
                <div class="span6">
                    <div class="btn-group nav-cluster">
                        {% if data.prev_url -%}
                            <a href="{{ data.prev_url }}" class="btn"><i class="icon-backward"></i> {{ data.prev_month }}</a>
                        {%- else -%}
                            <a href="#" class="btn disabled" onclick="return false;"><i class="icon-backward"></i> {{ data.prev_month }}</a>
                        {%- endif %}
                        <a href="../" class="btn">{{ data.this_year }}</a>
                        {% if data.next_url -%}
                            <a href="{{ data.next_url }}" class="btn">{{ data.next_month }} <i class="icon-forward"></i></a>
                        {%- else -%}
                            <a href="#" class="btn disabled" onclick="return false;">{{ data.next_month }} <i class="icon-forward"></i></a>
                        {%- endif %}
                    </div>
                </div>
            </div>
            <p>
                Browse:
                {% set i = 0 -%}
                {%- for day in data.days -%}
                    {%- set i = i + 1 -%}
                    <a href="{{ day }}/">{{ day }}</a> {% if i < data.days|length %}|{% endif %}
                {% endfor %}
            </p>
            <hr>
        </header>

        <section id="records" class="non-padded">
            <h2>Records</h2>
            <table class="table table-bordered">
                <thead>
                    <tr>
                        <th>Sensor</th>
                        <th>Min</th>
                        <th>Max</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Temperature</td>
                        <td>{{ data.records.min_temperature|round(1) }}°C at {{ data.records.min_temperature_ts }}</td>
                        <td>{{ data.records.max_temperature|round(1) }}°C at {{ data.records.max_temperature_ts }}</td>
                    </tr>
                    <tr>
                        <td>Apparent Temperature</td>
                        <td>{{ data.records.min_apparent_temperature|round(1) }}°C at {{ data.records.min_apparent_temperature_ts }}</td>
                        <td>{{ data.records.max_apparent_temperature|round(1) }}°C at {{ data.records.max_apparent_temperature_ts }}</td>
                    </tr>
                    <tr>
                        <td>Wind Chill</td>
                        <td>{{ data.records.min_wind_chill|round(1) }}°C at {{ data.records.min_wind_chill_ts }}</td>
                        <td>{{ data.records.max_wind_chill|round(1) }}°C at {{ data.records.max_wind_chill_ts }}</td>
                    </tr>
                    <tr>
                        <td>Dew Point</td>
                        <td>{{ data.records.min_dew_point|round(1) }}°C at {{ data.records.min_dew_point_ts }}</td>
                        <td>{{ data.records.max_dew_point|round(1) }}°C at {{ data.records.max_dew_point_ts }}</td>
                    </tr>
                    <tr>
                        <td>Humidity</td>
                        <td>{{ data.records.min_humidity }}% at {{ data.records.min_humidity_ts }}</td>
                        <td>{{ data.records.max_humidity }}% at {{ data.records.max_humidity_ts }}</td>
                    </tr>
                    <tr>
                        <td>Barometer</td>
                        <td>{{ data.records.min_absolute_pressure|round(1) }} hPa at {{ data.records.min_absolute_pressure_ts }}</td>
                        <td>{{ data.records.max_absolute_pressure|round(1) }} hPa at {{ data.records.max_absolute_pressure_ts }}</td>
                    </tr>
                    <tr>
                        <td>Gust Wind Speed</td>
                        <td class="no-value"></td>
                        <td>{{ data.records.max_gust_wind_speed|round(1) }} m/s at {{ data.records.max_gust_wind_speed_ts }}</td>
                    </tr>
                    <tr>
                        <td>Average Wind Speed</td>
                        <td class="no-value"></td>
                        <td>{{ data.records.max_average_wind_speed|round(1) }} m/s at {{ data.records.max_average_wind_speed_ts }}</td>
                    </tr>
                </tbody>
            </table>
            <p>Total Rainfall: {{ data.records.total_rainfall|round(1) }}mm</p>
        </section>

        <section id="charts">
        <h2>Monthly Charts</h2>
            <div id="month_charts">
                <div class="row">
                    <div class="span12">
                        <div id="chart_temperature_tdp_div" class="chart">
                            <div class="bg_loading"></div>
                        </div>
                        <div id="chart_temperature_tdp_key" class="chart_key"></div>
                    </div>
                </div>
                <div class="row">
                    <div class="span12">
                        <div id="chart_temperature_awc_div" class="chart">
                            <div class="bg_loading"></div>
                        </div>
                        <div id="chart_temperature_awc_key" class="chart_key"></div>
                    </div>
                </div>
                <div class="row">
                    <div class="span12">
                        <div id="chart_humidity_div" class="chart">
                            <div class="bg_loading"></div>
                        </div>
                        <div id="chart_humidity_key" class="chart_key"></div>
                    </div>
                </div>
                <div class="row">
                    <div class="span12">
                        <div id="chart_pressure_div" class="chart">
                            <div class="bg_loading"></div>
                        </div>
                        <div id="chart_pressure_key" class="chart_key"></div>
                    </div>
                </div>
                {%- if solar_uv_available %}
                <div class="row">
                    <div class="span12">
                        <div id="chart_solar_radiation_div" class="chart">
                            <div class="bg_loading"></div>
                        </div>
                        <div id="chart_solar_radiation_key" class="chart_key"></div>
                    </div>
                </div>
                <div class="row">
                    <div class="span12">
                        <div id="chart_uv_index_div" class="chart">
                            <div class="bg_loading"></div>
                        </div>
                        <div id="chart_uv_index_key" class="chart_key"></div>
                    </div>
                </div>
                {%- endif %}
                <div class="row">
                    <div class="span12">
                        <div id="chart_wind_speed_div" class="chart">
                            <div class="bg_loading"></div>
                        </div>
                        <div id="chart_wind_speed_key" class="chart_key"></div>
                    </div>
                </div>
            </div>
            <div id="lc_refresh_failed" style="display: none;">
                <div class="alert alert-warning">
                    <strong>Unable to plot charts</strong> - failed to retrieve data.
                </div>
            </div>
            <div id="lc_obsolete_browser" style="display: none;">
                <div class="alert alert-warning" id="lc_msg">
                    Charts disabled due to obsolete browser.
                </div>
            </div>
        </section>

        <section id="daily_record_charts">
            <h2>Daily Records</h2>
            <div id="records_charts">
                <div class="row">
                    <div class="span6">
                        <div id="chart_rec_temperature" class="chart">
                            <div class="bg_loading"></div>
                        </div>
                        <div id="key_rec_temperature" class="chart_key"></div>
                    </div>
                    <div class="span6">
                        <div id="chart_rec_pressure" class="chart">
                            <div class="bg_loading"></div>
                        </div>
                        <div id="key_rec_pressure" class="chart_key"></div>
                    </div>
                </div>
                <div class="row">
                    <div class="span6">
                        <div id="chart_rec_humidity" class="chart">
                            <div class="bg_loading"></div>
                        </div>
                        <div id="key_rec_humidity" class="chart_key"></div>
                    </div>
                    <div class="span6">
                        <div id="chart_rainfall" class="chart">
                            <div class="bg_loading"></div>
                        </div>
                        <div id="key_rainfall" class="chart_key"></div>
                    </div>
                </div>
                <div class="row">
                    <div class="span6">
                        <div id="chart_rec_wind_speed" class="chart">
                            <div class="bg_loading"></div>
                        </div>
                        <div id="key_rec_wind_speed" class="chart_key"></div>
                    </div>
                    <div class="span6">

                    </div>
                </div>
            </div>
            <div id="lcr_refresh_failed" style="display: none;">
                <div class="alert alert-warning">
                    <strong>Unable to plot charts</strong> - failed to retrieve data.
                </div>
            </div>
            <div id="lcr_obsolete_browser" style="display: none;">
                <div class="alert alert-warning" id="lcr_msg">
                    Charts disabled due to obsolete browser.
                </div>
            </div>
        </section>
{% endblock %}
{% block scripts %}
    <script type="text/javascript">
    // URLs required by month_charts.js
    var samples_url = '{{ dataurls.samples_30m_avg }}';
    var daily_records_url = '{{ dataurls.daily_records }}';
    var hw_type = '{{ hw_type }}';
    {%- if hw_type == 'DAVIS' %}
    var solar_and_uv_available = {% if solar_uv_available %}true{% else %}false{% endif %};
    {% endif %}
    </script>
    {% if ui and ui in ('s', 'm') -%}
    <script type="text/javascript" src="../../../../js/dygraph-combined.js"></script>
    <script type="text/javascript" src="../../../../js/dygraph-charts.js"></script>
    <script type="text/javascript" src="../../../../js/month_charts_dygraph.js"></script>
    {% else -%}
    <script type="text/javascript" src="http://www.google.com/jsapi"></script>
    <script type="text/javascript" src="../../../../js/month_charts_gviz.js"></script>
    {%- endif -%}
{% endblock %}
